user,search
webintelligence,"search eventtype=web-traffic  eventtype=ua-bot-* NOT (eventtype=ua-bot-nagios OR eventtype=clientip-nonroutable OR eventtype=clientip-internal OR useragent=""-"") | eval eventtype=mvfilter(match(eventtype, ""ua\-bot\-.*""))| top eventtype"
webintelligence,search eventtype=pageview | top uri_path
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Pageview*""| top uri"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Assets documents*"" | top uri_path"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Assets media*"" | top uri_path"
webintelligence,search eventtype=pageview (method=GET OR method=POST)  | top clientip
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"") ] source=""User session nonsingle eventcount*""| makemv timeandduration | mvexpand timeandduration | eval _time=tonumber(substr(timeandduration,1,10)) | eval duration = tonumber(substr(timeandduration,12))/60 | timechart  perc25(duration) as ""25th Percentile"", median(duration) as ""Median"", perc75(duration) as ""75th Percentile"""
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Referer phrases*"" | top q"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Referer phrases*"" | rex field=q max_match=20 ""(?<keywords>\w+)"" | top limit=100 keywords | lookup stopwords keywords | fillnull alwaysone | search alwaysone=0 | sort limit=10 - count | fields - alwaysone"
webintelligence,"search eventtype=pageview eventtype=ua-feedreader* | eval eventtype=mvfilter(match(eventtype, ""ua\-feedreader.*""))| top eventtype"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"") ] source=""User session visitor source*"" | eval eventcount = myeventcount | eval user_type=case(eventcount=1, ""bounce"", eventcount<=5, ""2-5 pages"", eventcount<=10,""6-10 pages"", eventcount>10, "">10 pages"") | stats count by user_type"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Organic brand*""| top q"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Organic nonbrand*""| top q"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Brand*"" | timechart limit=5 sum(mycount) BY q | fields - OTHER"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Referer category*"" | eval eventtype = myeventtype | top eventtype"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Referer breakdown*"" | eval eventtype = myeventtype | top referer_domain BY eventtype"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""User session browser stats*""| makemv uniqip | top browser"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""User session mobile stats*""| makemv uniqip | top platform"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""User session handheld count*"" | makemv myips | stats dc(myips) as count by ismobile"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""User session demographics*"" | lookup local=true geoip clientip | stats count BY client_country, client_region"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"") ] source=""User session visitor source*"" | timechart eval(sum(myeventcount)) AS pageviews, dc(clientip) AS unique_visitors, eval((sum(myeventcount))/dc(clientip)) AS avg_pageviews"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"") ] source=""User session visitor source*"" | eval eventcount=myeventcount  | makemv delim="" "" myeventtypes | eval eventtype=myeventtypes | eval eventtype=mvfilter(match(eventtype, ""visitor\-type\-.*"")) | eval eventtype=mvindex(eventtype, 0) |  stats count, avg(myduration) AS avg_duration, avg(eventcount) AS avg_eventcount BY eventtype, _time"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval uri_path=if(uri_path=""/"", ""/"", rtrim(uri_path, ""/""))| transaction clientip sourcename maxpause=1h keepevicted=t mvlist=t | search eventcount>1 eventtype=goal-* | eval landing_page=mvindex(uri_path, 0) | top landing_page"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"") ] source=""User session nonsingle eventcount*"" | makemv landing_page | mvexpand landing_page | top landing_page"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"") ] source=""User session nonsingle eventcount*"" | makemv exit_page | mvexpand exit_page | top exit_page"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Web Traffic goodstatus*"" | eval status=toString(floor(status/100))+""xx""  | stats values(myclientip) as myips sum(hits) as myhits by uri, status | mvexpand myips | stats dc(myips) as ""unique ips"" max(myhits) as ""total count"" by uri, status"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] (source=""Web Traffic goodstatus fivemin summary*"" OR source=""Web Traffic goodstatus hourly summary*"" OR source=""Web Traffic goodstatus daily summary*"") | lookup httpstatus status | eval mystatus=status+""-""+status_description | timechart sum(hits) BY mystatus"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Web Traffic badstatus*"" | eval status=toString(floor(status/100))+""xx""  | stats values(myclientip) as myips sum(hits) as myhits by uri, status | mvexpand myips | stats dc(myips) as ""unique ips"" max(myhits) as ""total count"" by uri, status"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] (source=""Web Traffic badstatus fivemin summary*"" OR source=""Web Traffic badstatus hourly summary*"" OR source=""Web Traffic badstatus daily summary*"") | lookup httpstatus status | eval mystatus=status+""-""+status_description | timechart sum(hits) BY mystatus"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Web Traffic by host*"" | timechart sum(hits) BY myhost | rename myhost as host"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Web Traffic by bots*"" | eval bots=substr(bots,8)| timechart sum(hits) by bots"
webintelligence,"search earliest=-48h@h latest=now  search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""Web Traffic badstatus*"" | eval status=toString(floor(status/100))+""xx""  | stats values(myclientip) as myips sum(hits) as myhits min(earliest_hit) as first, max(latest_hit) as last by uri, status | mvexpand myips | stats dc(myips) as ""unique ips"" max(myhits) as ""total count"" min(first) as first max(last) as last by uri, status | eval dif=last-first | search dif<86400 ""total count"">10"
webintelligence,"search host=* [ stats count | addinfo | eval range=info_max_time - info_min_time | eval search=if(range<=3605, ""index=wi_summary_fivemin"", if(range<=(86400+3600),""index=wi_summary_hourly"",""index=wi_summary_daily"")) ] source=""User session demographics*""| stats min(earliestvisit) as firstvisit by clientip | lookup userlistbyclientip.csv clientip OUTPUT firstvisit as earliestvisit | eval firstvisit=if(isnull(earliestvisit),firstvisit,earliestvisit) | addinfo | eval isnew=if(firstvisit>=info_min_time, ""New Visitors"" , ""Returning Visitors"") | stats count by isnew"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval uri_path=if(uri_path=""/"", ""/"", rtrim(uri_path, ""/""))| transaction clientip sourcename maxpause=1h keepevicted=t mvlist=t | stats min(_time) as firstvisit by clientip | inputlookup append=t userlistbyclientip.csv | stats min(firstvisit) as firstvisit by clientip | fields clientip firstvisit | outputlookup userlistbyclientip.csv"
webintelligence,"search eventtype=web-traffic | stats count by source | eval sourcename="" "" | inputlookup append=t sourcenames.csv | stats last(sourcename) as sourcename by source | outputlookup sourcenames.csv"
webintelligence,"search eventtype=""web-traffic-external"" status>100 status<300 |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | stats count as ""hits"" min(_time) as earliest_hit, max(_time) as latest_hit by uri, status, sourcename"
webintelligence,"search eventtype=""web-traffic-external"" status>=300 |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | stats count as ""hits"" min(_time) as earliest_hit, max(_time) as latest_hit by uri, status, sourcename"
webintelligence,"search eventtype=""web-traffic-external"" status>100 status<300 |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | stats values(clientip) as myclientip by uri, status, sourcename"
webintelligence,"search eventtype=""web-traffic-external"" status>=300 |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | stats values(clientip) as myclientip by uri, status, sourcename"
webintelligence,"search eventtype=web-traffic  eventtype=ua-bot-* NOT (eventtype=ua-bot-nagios OR eventtype=clientip-nonroutable OR eventtype=clientip-internal OR useragent=""-"") |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | eval bots=mvfilter(match(eventtype, ""ua\-bot\-.*""))| stats count as hits by bots, sourcename"
webintelligence,"search eventtype=""web-traffic-external"" |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | eval myhost=host | stats count as ""hits"" by myhost, sourcename"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | stats min(_time) as earliestvisit first(sourcename) as sourcename by clientip"
webintelligence,"search eventtype=pageview | eval ismobile=if(match(eventtype,""ua-mobile-*""),""Handheld"",""PC"") |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | stats values(clientip) as myips by ismobile, sourcename"
webintelligence,"search eventtype=pageview eventtype=ua-mobile* | eval platform=substr(mvfilter(match(eventtype, ""ua\-mobile\-.*"")),11) |   lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | stats values(clientip) as uniqip by platform, sourcename"
webintelligence,"search eventtype=pageview eventtype=ua-browser* | eval browser=substr(mvfilter(match(eventtype, ""ua\-browser\-.*"")),12) |   lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | stats values(clientip) as uniqip by browser, sourcename"
webintelligence,"search eventtype=pageview |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | sitop uri by sourcename"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* eventtype=""search-referer"" NOT (eventtype=visitor-type-paid OR eventype=internal-referer) | eval q=if(isnull(q) AND isnotnull(p), p, q) | eval q=urldecode(q) | eval q=trim(lower(q)) |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | search eventtype=brand-name | sitop q by sourcename"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* eventtype=""search-referer"" NOT (eventtype=visitor-type-paid OR eventype=internal-referer) | eval q=if(isnull(q) AND isnotnull(p), p, q) | eval q=urldecode(q) | eval q=trim(lower(q)) |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | search eventtype!=brand-name | sitop q by sourcename"
webintelligence,"search eventtype=brand-name  search eventtype=pageview eventtype=ua-browser-* eventtype=""search-referer"" NOT (eventtype=visitor-type-paid OR eventype=internal-referer) | eval q=if(isnull(q) AND isnotnull(p), p, q) | eval q=urldecode(q) | eval q=trim(lower(q)) |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | stats count as mycount BY q, sourcename | fields - OTHER"
webintelligence,"search eventtype=resourceview method=GET status=200 eventtype=file-documents |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | eval uri_path=replace(uri_path, ""//"", ""/"") | search uri_path!=""*robots.txt"" | sitop uri_path by sourcename"
webintelligence,"search eventtype=resourceview method=GET  uri!=""*flash_components*"" eventtype=file-media |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | sitop uri_path by sourcename"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* eventtype=*-referer NOT eventtype=internal-referer| dedup clientip |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | eval eventtype=mvfilter(match(eventtype, "".*\-referer$""))| eval myeventtype=eventtype | sitop myeventtype by sourcename"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* eventtype=*-referer NOT referer=""-""  |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | eval eventtype=mvfilter(match(eventtype, "".*\-referer$"")) | eval referer_domain=if(match(referer_domain, "".*google|doubleclick.*""), ""*google*"", referer_domain)| eval myeventtype=eventtype | sitop referer_domain BY myeventtype, sourcename"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* eventtype=search-referer (q=* OR p=*) |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | eval q=if(isnull(q) AND isnotnull(p), p, q)  | eval q=trim(lower(urldecode(q)))  | stats count by q, sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Web Traffic goodstatus fivemin summary*""| stats sum(hits) as hits min(earliest_hit) as earliest_hit max(latest_hit) as latest_hit by uri, status, sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Web Traffic badstatus fivemin summary*""| stats sum(hits) as hits min(earliest_hit) as earliest_hit max(latest_hit) as latest_hit by uri, status, sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Web Traffic goodstatus by clientip*"" | stats values(myclientip) as myclientip by uri, status, sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Web Traffic badstatus by clientip*"" | stats values(myclientip) as myclientip by uri, status, sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Web Traffic by bots*""| stats sum(hits) as hits by bots, sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Web Traffic by host*""| stats sum(hits) as hits by myhost, sourcename"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval uri_path=if(uri_path=""/"", ""/"", rtrim(uri_path, ""/""))| transaction clientip sourcename maxpause=1h keepevicted=t mvlist=t | stats max(duration) as myduration max(eventcount) as myeventcount values(eventtype) as myeventtypes first(sourcename) as sourcename by clientip, _time"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval uri_path=if(uri_path=""/"", ""/"", rtrim(uri_path, ""/""))| transaction clientip sourcename maxpause=1h keepevicted=t mvlist=t | search eventcount>1 | stats max(duration) as duration first(uri_path) as landing_page last(uri_path) as exit_page first(sourcename) as sourcename by clientip, _time  | eval timeandduration=_time+"":""+duration | stats list(timeandduration) as timeandduration list(landing_page) as landing_page list(exit_page) as exit_page by sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""User session demographics*""  | stats min(earliestvisit) as earliestvisit first(sourcename) as sourcename by clientip"
webintelligence,"search index=""wi_summary_fivemin"" source=""User session handheld count*"" | stats values(myips) as myips by ismobile, sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""User session mobile stats*""  | stats values(uniqip) as uniqip by platform, sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""User session browser stats*"" | stats values(uniqip) as uniqip by browser, sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Pageview*""| sitop uri by sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Organic brand search fivemin summary*""| sitop q by sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Organic nonbrand search fivemin summary*""| sitop q by sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Brand search fivemin summary*"" | stats sum(mycount) as mycount BY q, sourcename | fields - OTHER"
webintelligence,"search index=""wi_summary_fivemin"" source=""Assets documents*"" | sitop uri_path by sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Assets media*"" | sitop uri_path by sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Referer category*"" | sitop myeventtype by sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Referer breakdown*"" | sitop referer_domain BY myeventtype, sourcename"
webintelligence,"search index=""wi_summary_fivemin"" source=""Referer phrases*"" | stats count by q, sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Web Traffic goodstatus hourly summary*""| stats sum(hits) as hits min(earliest_hit) as earliest_hit max(latest_hit) as latest_hit by uri, status, sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Web Traffic badstatus hourly summary*""| stats sum(hits) as hits min(earliest_hit) as earliest_hit max(latest_hit) as latest_hit by uri, status, sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Web Traffic goodstatus by clientip*"" | stats values(myclientip) as myclientip by uri, status, sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Web Traffic badstatus by clientip*"" | stats values(myclientip) as myclientip by uri, status, sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Web Traffic by bots*""| stats sum(hits) as hits by bots, sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Web Traffic by host*""| stats sum(hits) as hits by myhost, sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""User session visitor source*""  | transaction clientip maxpause=1h keepevicted=t mvlist=t | stats max(myduration) as myduration max(myeventcount) as myeventcount values(myeventtypes) as myeventtypes first(sourcename) as sourcename by clientip, _time"
webintelligence,"search index=""wi_summary_hourly"" source=""User session nonsingle eventcount*""  | stats list(timeandduration) as timeandduration list(landing_page) as landing_page list(exit_page) as exit_page  by sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""User session demographics*""  | stats min(earliestvisit) as earliestvisit first(sourcename) as sourcename by clientip"
webintelligence,"search index=""wi_summary_hourly"" source=""User session handheld count*"" | stats values(myips) as myips by ismobile, sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""User session mobile stats*""  | stats values(uniqip) as uniqip by platform, sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""User session browser stats*"" | stats values(uniqip) as uniqip by browser, sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Pageview*""| sitop uri by sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Organic brand search*""| sitop q by sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Organic nonbrand search*""| sitop q by sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Brand search*"" | stats sum(mycount) as mycount BY q, sourcename | fields - OTHER"
webintelligence,"search index=""wi_summary_hourly"" source=""Assets documents*"" | sitop uri_path by sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Assets media*"" | sitop uri_path by sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Referer category*"" | sitop myeventtype by sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Referer breakdown*"" | sitop referer_domain BY myeventtype, sourcename"
webintelligence,"search index=""wi_summary_hourly"" source=""Referer phrases*"" | stats count by q, sourcename"
webintelligence,"search eventtype=web-traffic-external status>100 status<300 |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval status=toString(floor(status/100))+""xx"" | stats dc(clientip) as ""unique ips"" count as ""total count"" by uri, status"
webintelligence,"search eventtype=""web-traffic-external"" status>100 status<300 |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | lookup httpstatus status | eval mystatus=status+""-""+status_description | timechart count BY mystatus"
webintelligence,"search eventtype=web-traffic-external status>=300 status<600 |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval status=toString(floor(status/100))+""xx"" | stats dc(clientip) as ""unique ips"" count as ""total count"" by uri, status"
webintelligence,"search eventtype=""web-traffic-external"" status>=300 status<600 |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | lookup httpstatus status | eval mystatus=status+""-""+status_description | timechart count BY mystatus"
webintelligence,"search eventtype=""web-traffic-external"" |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | timechart count BY host"
webintelligence,"search eventtype=web-traffic  eventtype=ua-bot-* NOT (eventtype=ua-bot-nagios OR eventtype=clientip-nonroutable OR eventtype=clientip-internal OR useragent=""-"") |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval eventtype=mvfilter(match(eventtype, ""ua\-bot\-.*""))| eval bots=substr(eventtype,8)| timechart count BY bots"
webintelligence,"search eventtype=""web-traffic-external"" status=""4*"" OR status=""5*"" OR status=""3*"" |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval status=toString(floor(status/100))+""xx""| stats dc(clientip) as ""unique ips"" count as ""total count"", min(_time) as first, max(_time) as last BY uri, status | eval dif=last-first | search dif<86400 ""total count"">10"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* eventtype=""search-referer"" NOT (eventtype=visitor-type-paid OR eventype=internal-referer) | eval q=if(isnull(q) AND isnotnull(p), p, q) | eval q=urldecode(q) | eval q=trim(lower(q)) |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | search eventtype=brand-name | search q!=NULL | top q"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* eventtype=""search-referer"" NOT (eventtype=visitor-type-paid OR eventype=internal-referer) | eval q=if(isnull(q) AND isnotnull(p), p, q) | eval q=urldecode(q) | eval q=trim(lower(q)) |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | search eventtype!=brand-name | search q!=NULL | top q"
webintelligence,"search eventtype=brand-name  search eventtype=pageview eventtype=ua-browser-* eventtype=""search-referer"" NOT (eventtype=visitor-type-paid OR eventype=internal-referer) | eval q=if(isnull(q) AND isnotnull(p), p, q) | eval q=urldecode(q) | eval q=trim(lower(q)) |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | search q!=NULL | timechart limit=5 count BY q | fields - OTHER"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* eventtype=*-referer NOT eventtype=internal-referer| dedup clientip |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | eval eventtype=mvfilter(match(eventtype, "".*\-referer$""))|top eventtype"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* eventtype=*-referer NOT referer=""-""  |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | eval eventtype=mvfilter(match(eventtype, "".*\-referer$"")) | eval referer_domain=if(match(referer_domain, "".*google|doubleclick.*""), ""*google*"", referer_domain)| top referer_domain BY eventtype"
webintelligence,"search eventtype=pageview eventtype=ua-browser* | dedup clientip |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | eval eventtype=mvfilter(match(eventtype, ""ua\-browser\-.*"")) | eval browser=substr(eventtype,12) | top browser"
webintelligence,"search eventtype=pageview eventtype=ua-mobile* | dedup clientip |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | eval eventtype=mvfilter(match(eventtype, ""ua\-mobile\-.*"")) | eval platform=substr(eventtype,11) | top platform"
webintelligence,"search eventtype=pageview | dedup clientip |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval ismobile=if(match(eventtype,""ua-mobile-*""),""Handheld"",""PC"") | stats count by ismobile"
webintelligence,"search eventtype=pageview eventtype=ua-browser*  | dedup clientip |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | lookup local=true geoip clientip | stats count BY client_country, client_region"
webintelligence,"search eventtype=pageview eventtype=ua-browser* |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | timechart count AS pageviews, dc(clientip) AS unique_visitors, eval(count/dc(clientip)) AS avg_pageviews"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval uri_path=if(uri_path=""/"", ""/"", rtrim(uri_path, ""/""))| transaction clientip sourcename maxpause=1h keepevicted=t mvlist=t | eval eventtype=mvfilter(match(eventtype, ""visitor\-type\-.*"")) | eval eventtype=mvindex(eventtype, 0) |  stats count, avg(duration) AS avg_duration, avg(eventcount) AS avg_eventcount BY eventtype, _time"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval uri_path=if(uri_path=""/"", ""/"", rtrim(uri_path, ""/""))| transaction clientip sourcename maxpause=1h keepevicted=t mvlist=t | search eventcount>1 | eval landing_page=mvindex(uri_path, 0) |  fields landing_page sourcename | top landing_page"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval uri_path=if(uri_path=""/"", ""/"", rtrim(uri_path, ""/""))| transaction clientip sourcename maxpause=1h keepevicted=t mvlist=t | search eventcount>1 | eval exit_page=mvindex(uri_path, -1) | fields exit_page sourcename | top exit_page"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval uri_path=if(uri_path=""/"", ""/"", rtrim(uri_path, ""/""))| transaction clientip sourcename maxpause=1h keepevicted=t mvlist=t | stats min(_time) as firstvisit by clientip | lookup userlistbyclientip.csv clientip OUTPUT firstvisit as earliestvisit | eval firstvisit=if(isnull(earliestvisit),firstvisit,earliestvisit) | addinfo | eval isnew=if(firstvisit>=info_min_time, ""New Visitors"" , ""Returning Visitors"") | stats count by isnew"
webintelligence,"search eventtype=pageview |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | top uri"
webintelligence,"search eventtype=resourceview method=GET status=200 eventtype=file-documents |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | eval uri_path=replace(uri_path, ""//"", ""/"") | search uri_path!=""*robots.txt"" | top uri_path"
webintelligence,"search eventtype=resourceview method=GET  uri!=""*flash_components*"" eventtype=file-media |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | top uri_path"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval uri_path=if(uri_path=""/"", ""/"", rtrim(uri_path, ""/""))| transaction clientip sourcename maxpause=1h keepevicted=t mvlist=t |  search eventcount>1 | eval duration = duration/60 | timechart  perc25(duration) as ""25th Percentile"", median(duration) as ""Median"", perc75(duration) as ""75th Percentile"""
webintelligence,"search eventtype=pageview eventtype=ua-browser-* eventtype=search-referer (q=* OR p=*) |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | eval q=if(isnull(q) AND isnotnull(p), p, q) | eval q=trim(lower(urldecode(q))) | top q"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* eventtype=search-referer (q=* OR p=*) |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename)  | eval q=if(isnull(q) AND isnotnull(p), p, q) | eval q=trim(lower(urldecode(q))) | rex field=q max_match=20 ""(?<keywords>\w+)"" | top limit=100 keywords | lookup stopwords keywords | fillnull alwaysone | search alwaysone=0 | sort limit=10 - count | fields - alwaysone"
webintelligence,"search eventtype=pageview eventtype=ua-browser-* |  lookup sourcenames source | eval sourcename=if(sourcename=="" "" OR isnull(sourcename),source,sourcename) | eval uri_path=if(uri_path=""/"", ""/"", rtrim(uri_path, ""/""))| transaction clientip sourcename maxpause=1h keepevicted=t mvlist=t | eval user_type=case(eventcount=1, ""bounce"", eventcount<=5, ""2-5 pages"", eventcount<=10,""6-10 pages"", eventcount>10, "">10 pages"") | stats count by user_type"
